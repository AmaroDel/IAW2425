<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario</title>
    <style>
        span {
            color: red;
        }
    </style>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

</head>

<body>
    <form action="">
        <label for="">Nombre</label><input type="text" id="nombre" required><span class="error" id="campo1"></span><br>
        <label for="">Apellido1</label><input type="text" id="apellido" required><span class="error"
            id="campo2"></span><br>
        <label for="">Apellido2</label><input type="text" id="apellido2" required><span class="error"
            id="campo3"></span><br>
        <label for="">DNI</label><input type="text" id="dni" required onkeyup="sin_espacio(dni)"><span class="error"
            id="campo4"></span><br>
        <label for="">Correo Electronico</label><input type="email" id="correo" required><span class="error"
            id="campo5"></span><br>
        <label for="">Contraseña</label><input type="password" id="contrasena" required
            onkeyup="sin_espacio(contrasena)"><span class="error" id="campo6"></span><br>
        <label for="">Repita la contraseña</label><input type="password" id="contrasena2" required
            onkeyup="sin_espacio(contrasena2)"><span class="error" id="campo7"></span><br>
        <label for="">Descripción</label><input type="email" id="correo" required><span class="error"
            id="campo8"></span><br>
        <label for="">Fecha de nacimiento</label><input type="email" id="correo" required><span class="error"
            id="campo9"></span><br>
        <input type="checkbox" name="" id="privacidad" required><label for="">Acepta el tratamiento de los datos</label><span
            id="campo10"></span><br>

        <button id="enviar" onclick="validar()">Enviar</button>
        <p id="respuesta"></p>
    </form>

    <script>
        function validar() {
            event.preventDefault()
            document.getElementById("respuesta").innerHTML = ""
            let nombre = document.getElementById("nombre").value
            let apellido = document.getElementById("apellido").value
            let apellido2 = document.getElementById("apellido2").value
            let correo = document.getElementById("correo").value
            let dni = document.getElementById("dni").value
            let contrasena = document.getElementById("contrasena").value
            let contrasena2 = document.getElementById("contrasena2").value
            let patronEmail = /^\w+([.-_+]?\w+)*@\w+([.-]?\w+)*(\.\w{2,10})+$/;
            $(document).ready(function () {
                let privacidad = $("#privacidad").is(":checked")
            });

            let n = nombre.substr(0, 1);
            let a = apellido.substr(0, 3);
            let a2 = apellido2.substr(0, 3);
            let d = dni.substr(5, 3);
            let usuario = (n + a + a2 + d).toLowerCase(); // Convertir a minúsculas*/

            let hayErrores = false;



            if (nombre == "") {
                document.getElementById("campo1").innerHTML = "El campo nombre es necesario para completar el formulario"
                hayErrores = true;
            } else {
                document.getElementById("campo1").innerHTML = ""
            }

            if (apellido == "") {
                document.getElementById("campo2").innerHTML = "El campo apellido es necesario para completar el formulario"
                hayErrores = true;
            } else {
                document.getElementById("campo2").innerHTML = ""
            }

            if (apellido2 == "") {
                document.getElementById("campo3").innerHTML = "El campo apellido2 es necesario para completar el formulario"
                hayErrores = true;
            } else {
                document.getElementById("campo3").innerHTML = ""
            }

            if (correo == "") {
                document.getElementById("campo5").innerHTML = "El campo correo es necesario para completar el formulario"
                hayErrores = true;
            } else if (!patronEmail.test(correo)) {  // Validar formato del correo
                document.getElementById("campo5").innerHTML = "Formato de correo no válido"
                hayErrores = true;
            } else {
                document.getElementById("campo5").innerHTML = ""
            }

            if (dni == "") {
                document.getElementById("campo4").innerHTML = "Rellene este campo"
                hayErrores = true;
            }
            else if (dni.length != 9) {
                document.getElementById("campo4").innerHTML = "12345678X"
                hayErrores = true;
            }
            else {
                document.getElementById("campo4").innerHTML = ""
                validarDNI()
            }

            if (contrasena == "") {
                document.getElementById("campo6").innerHTML = "El campo contraseña es necesario para completar el formulario"
                hayErrores = true;
            }
            else if (contrasena.length < 8) {
                document.getElementById("campo6").innerHTML = "Mínimo 8 digitos"
                hayErrores = true;
            } else if (contrasena != contrasena2) {
                document.getElementById("campo6").innerHTML = "Las contraseñas no son iguales"
                hayErrores = true;
            }
            else {
                document.getElementById("campo6").innerHTML = ""
            }



            if (contrasena2 == "") {
                document.getElementById("campo7").innerHTML = "El campo contraseña2 es necesario para completar el formulario"
                hayErrores = true;
            }
            else if (contrasena2.length < 8) {
                document.getElementById("campo7").innerHTML = "Mínimo 8 digitos"
                hayErrores = true;
            } else if (contrasena != contrasena2) {
                document.getElementById("campo7").innerHTML = "Las contraseñas no son iguales"
                hayErrores = true;
            }
            else {
                document.getElementById("campo7").innerHTML = ""
            }

            if (!privacidad) {
                document.getElementById("campo10").innerHTML = "El campo verificación es necesario para completar el formulario"
                hayErrores = true;
            }
            else {
                document.getElementById("campo10").innerHTML = ""
            }

            if (!hayErrores) {
                document.getElementById("respuesta").innerHTML = "Usuario: " + usuario
            }
        }

        function validarDNI() {

            let dni = document.getElementById("dni").value
            let letra = dni[8]

            //Función calcula letras cogida de otro ejercicio
            let letras = ["T", "R", "W", "A", "G", "M", "Y", "F", "P", "D", "X", "B", "N", "J", "Z", "S", "Q", "V", "H", "L", "C", "K", "E"];
            let numero = parseInt(document.getElementById("dni").value);
            let resto = numero % 23; //Resto de la división entre 23
            letras[resto];
            //FIN

            if (letra != letras[resto]) {
                document.getElementById("campo4").innerHTML = "DNI no valido"
            }
        }

        function sin_espacio(elemento) {
            elemento.value = elemento.value.replace(/ /g, '')
        }



    </script>

</body>

</html>