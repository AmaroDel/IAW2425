<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ejercicio 1</title>
    <script src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
    <style>
        span {
            color: red;
        }
    </style>
</head>

<body>
    <form action="">
        <label for=""></label>Asunto*:<input type="text" id="asunto" required><span class="error"
            id="campo1"></span><br>
        <label for=""></label>DNI/NIE*:<input type="text" id="dni" required><span class="error" id="campo2"></span><br>
        <label for=""></label>Nombre*:<input type="text" id="nombre" required><span class="error"
            id="campo3"></span><br>
        <label for=""></label>Primer apellido*:<input type="text" id="apellido1" required><span class="error"
            id="campo4"></span><br>
        <label for=""></label>Segundo apellido:<input type="text" id="apellido2"><br>
        <label for=""></label>Fecha de nacimiento (dd/mm/yyyy)*:<input type="date" id="fecha" required><span
            class="error" id="campo5"></span><br>
        <label for=""></label>Telefono de contacto*:<input type="text" id="telefono" required><span class="error"
            id="campo6"></span><br>
        <label for=""></label>Correo Electrónico(para respuesta):<input type="email" id="correo"><br>
        <label for=""></label>Domicilio*:<input type="text" id="domicilio" required><span class="error"
            id="campo7"></span><br>
        <label for=""></label>Codigo Postal*:<input type="text" id="postal" required><span class="error"
            id="campo8"></span><br>
        <label for=""></label>Municipio*<select class="form-control" name="clave" id="municipio" required><span
                class="error" id="campo9"></span>
            <option value="41001">Aguadulce</option>
            <option value="41002">Alanís</option>
            <option value="41003">Albaida del Aljarafe</option>
            <option value="41004">Alcalá de Guadaíra</option>
            <option value="41005">Alcalá del Río</option>
            <option value="41006">Alcolea del Río</option>
            <option value="41007">Algaba (La)</option>
            <option value="41008">Algámitas</option>
            <option value="41009">Almadén de la Plata</option>
            <option value="41010">Almensilla</option>
            <option value="41011">Arahal</option>
            <option value="41012">Aznalcázar</option>
            <option value="41013">Aznalcóllar</option>
            <option value="41014">Badolatosa</option>
            <option value="41015">Benacazón</option>
            <option value="41016">Bollullos de la Mitación</option>
            <option value="41017">Bormujos</option>
            <option value="41018">Brenes</option>
            <option value="41019">Burguillos</option>
            <option value="41020">Cabezas de San Juan (Las)</option>
            <option value="41021">Camas</option>
            <option value="41022">Campana (La)</option>
            <option value="41023">Cantillana</option>
            <option value="41901">Cañada Rosal</option>
            <option value="41024">Carmona</option>
            <option value="41025">Carrión de los Céspedes</option>
            <option value="41026">Casariche</option>
            <option value="41027">Castilblanco de los Arroyos</option>
            <option value="41028">Castilleja de Guzmán</option>
            <option value="41029">Castilleja de la Cuesta</option>
            <option value="41030">Castilleja del Campo</option>
            <option value="41031">Castillo de las Guardas (El)</option>
            <option value="41032">Cazalla de la Sierra</option>
            <option value="41033">Constantina</option>
            <option value="41034">Coria del Río</option>
            <option value="41035">Coripe</option>
            <option value="41036">Coronil (El)</option>
            <option value="41037">Corrales (Los)</option>
            <option value="41903">Cuervo de Sevilla (El)</option>
            <option value="41038">Dos Hermanas</option>
            <option value="41039">Ecija</option>
            <option value="41040">Espartinas</option>
            <option value="41041">Estepa</option>
            <option value="41042">Fuentes de Andalucía</option>
            <option value="41043">Garrobo (El)</option>
            <option value="41044">Gelves</option>
            <option value="41045">Gerena</option>
            <option value="41046">Gilena</option>
            <option value="41047">Gines</option>
            <option value="41048">Guadalcanal</option>
            <option value="41049">Guillena</option>
            <option value="41050">Herrera</option>
            <option value="41051">Huévar del Aljarafe</option>
            <option value="41902">Isla Mayor</option>
            <option value="41052">Lantejuela</option>
            <option value="41053">Lebrija</option>
            <option value="41054">Lora de Estepa</option>
            <option value="41055">Lora del Río</option>
            <option value="41056">Luisiana (La)</option>
            <option value="41057">Madroño (El)</option>
            <option value="41058">Mairena del Alcor</option>
            <option value="41059">Mairena del Aljarafe</option>
            <option value="41060">Marchena</option>
            <option value="41061">Marinaleda</option>
            <option value="41062">Martín de la Jara</option>
            <option value="41063">Molares (Los)</option>
            <option value="41064">Montellano</option>
            <option value="41065">Morón de la Frontera</option>
            <option value="41066">Navas de la Concepción (Las)</option>
            <option value="41067">Olivares</option>
            <option value="41068">Osuna</option>
            <option value="41069">Palacios y Villafranca (Los)</option>
            <option value="41904">Palmar de Troya (El)</option>
            <option value="41070">Palomares del Río</option>
            <option value="41071">Paradas</option>
            <option value="41072">Pedrera</option>
            <option value="41073">Pedroso (El)</option>
            <option value="41074">Peñaflor</option>
            <option value="41075">Pilas</option>
            <option value="41076">Pruna</option>
            <option value="41077">Puebla de Cazalla (La)</option>
            <option value="41078">Puebla de los Infantes (La)</option>
            <option value="41079">Puebla del Río (La)</option>
            <option value="41080">Real de la Jara (El)</option>
            <option value="41081">Rinconada (La)</option>
            <option value="41082">Roda de Andalucía (La)</option>
            <option value="41083">Ronquillo (El)</option>
            <option value="41084">Rubio (El)</option>
            <option value="41085">Salteras</option>
            <option value="41086">San Juan de Aznalfarache</option>
            <option value="41088">San Nicolás del Puerto</option>
            <option value="41087">Sanlúcar la Mayor</option>
            <option value="41089">Santiponce</option>
            <option value="41090">Saucejo (El)</option>
            <option value="41091">Sevilla</option>
            <option value="41092">Tocina</option>
            <option value="41093">Tomares</option>
            <option value="41094">Umbrete</option>
            <option value="41095">Utrera</option>
            <option value="41096">Valencina de la Concepción</option>
            <option value="41097">Villamanrique de la Condesa</option>
            <option value="41100">Villanueva de San Juan</option>
            <option value="41098">Villanueva del Ariscal</option>
            <option value="41099">Villanueva del Río y Minas</option>
            <option value="41101">Villaverde del Río</option>
            <option value="41102">Viso del Alcor (El)</option>
        </select><br>
        <label for=""></label>Oficina*:<select id="oficina" required><span class="error" id="campo10"></span>
            <option>oficina 1</option>
            <option>oficina 2</option>
            <option>oficina 3</option>
            <option>oficina 4</option>
        </select><br>
        <label for="">Información requerida*:</label>
        <div><textarea id="informacion" rows="4" cols="50"
                required></div><span class="error" id="campo11"></span></textarea><br>
            <label for="">Fichero Anexo I (máximo 2MB):</label><input type="file" id="file1"><br>
            <label for="">Fichero Anexo II (máximo 2MB):</label><input type="file" id="file2"><br>
            <label for=""></label>He leído y acepto la <b><i>política de datos y normas de uso*</i></b><input
                type="checkbox" id="politica" required><span class="error" id="campo12"></span><br>
            <button id="boton">Enviar</button>
    </form>
</body>
<script>
    $(document).ready(function () {
        let oficina = document.getElementById('oficina');
        oficina.value = "";

        let municipio = document.getElementById('municipio');
        municipio.value = "";

        document.getElementById('file1').addEventListener('change', function () {
                const files = this.files;
                const maxSize = 1024 * 1024 * 2; // 2MB
                for (let i = 0; i < files.length; i++) {
                    if (files[i].size > maxSize) {
                        alert('El archivo ' + files[i].name + ' excede el tamaño máximo permitido de 2MB.');
                        // Elimina el archivo seleccionado
                        this.value = '';
                        return;
                    }
                }
            });
            document.getElementById('file2').addEventListener('change', function () {
                const files = this.files;
                const maxSize = 1024 * 1024 *2; // 2MB
                for (let i = 0; i < files.length; i++) {
                    if (files[i].size > maxSize) {
                        alert('El archivo ' + files[i].name + ' excede el tamaño máximo permitido de 2MB.');
                        // Elimina el archivo seleccionado
                        this.value = '';
                        return;
                    }
                }
            });

        $("#boton").click(function () {
            event.preventDefault()
            $(".error").empty();

            let patronDni = /^[0-9]{8}[TRWAGMYFPDXBNJZSQVHLCKET]$/i;
            let asunto = $("#asunto").val()
            let dni = $("#dni").val()
            let nombre = $("#nombre").val()
            let apellido1 = $("#apellido1").val()
            let fecha = $("#fecha").val()
            let telefono = $("#telefono").val()
            let domicilio = $("#domicilio").val()
            let postal = $("#postal").val()
            let municipio = $("#municipio").val()
            let oficina = $("#oficina").val()
            let informacion = $("#informacion").val()
            let politica = $("#politica").is(':checked')

            if (asunto == "") {
                $("#campo1").text("El campo Asunto es necesario para completar el formulario")
            }
            if (dni == "") {
                $("#campo2").text("El campo DNI/NIE es necesario para completar el formulario")
            } else {
                if (!patronDni.test(dni)) {
                    $("#campo2").text("12345678X")
                } else if (!calculaLetra(dni)) {
                    $("#campo2").text("La letra es erronea")
                }
            }
            if (nombre == "") {
                $("#campo3").text("El campo Nombre es necesario para completar el formulario")
            }
            if (apellido1 == "") {
                $("#campo4").text("El campo Primer apellido es necesario para completar el formulario")
            }
            if (fecha == "") {
                $("#campo5").text("El campo Fecha de nacimiento (dd/mm/yyyy) es necesario para completar el formulario")
            }
            if (telefono == "") {
                $("#campo6").text("El campo Telefono de contacto es necesario para completar el formulario")
            }
            if (domicilio == "") {
                $("#campo7").text("El campo Domicilio es necesario para completar el formulario")
            }
            if (postal == "") {
                $("#campo8").text("El campo Codigo Postal es necesario para completar el formulario")
            }
            if (municipio == "") {
                $("#campo9").text("El campo Municipio es necesario para completar el formulario")
            }
            if (oficina == "") {
                $("#campo10").text("El campo Oficina es necesario para completar el formulario")
            }
            if (informacion == "") {
                $("#campo11").text("El campo Información requerida es necesario para completar el formulario")
            }
            if (!politica) {
                $("#campo12").text("Acepte el tratamiento de sus datos")
            }


            function calculaLetra() {
                let letras = ["T", "R", "W", "A", "G", "M", "Y", "F", "P", "D", "X", "B", "N", "J", "Z", "S", "Q", "V", "H", "L", "C", "K", "E"];
                let numero = parseInt(document.getElementById("dni").value);
                let resto = numero % 23; //Resto de la división entre 23
                let letraCorrecta = letras[resto]
                let letraDni = dni.charAt(8).toUpperCase(); // Calcular la letra
                return letraCorrecta == letraDni; // Letra proporcionada
            }
        })

    });
</script>

</html>